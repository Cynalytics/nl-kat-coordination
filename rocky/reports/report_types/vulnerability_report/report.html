{% load i18n %}

{% if data %}
    <div>
        <div class="horizontal-scroll">
            <table>
                <caption class="visually-hidden">{% translate "Basic example table:" %}</caption>
                <thead>
                    <tr>
                        <th scope="col">{% translate "Vulnerabilities" %}</th>
                        <th scope="col">{% translate "Risk level" %}</th>
                        <th scope="col">{% translate "Unique findings" %}</th>
                        <th scope="col">{% translate "Occurrences" %}</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>
                    {% for vulnerability_name, vulnerability in data.items %}
                        <tr>
                            <td>{{ vulnerability_name }}</td>
                            <td>
                                <span class="{{ vulnerability.CVSS.class }}">{{ vulnerability.CVSS.severity }}</span>
                            </td>
                            <td>-</td>
                            <td>-</td>
                            <td class="actions">
                                <button class="expando-button"
                                        data-icon-open-class="icon ti-chevron-down"
                                        data-icon-close-class="icon ti-chevron-up"
                                        data-close-label="{% translate "Close details" %}">
                                    {% translate "Open details" %}
                                </button>
                            </td>
                        </tr>
                        <tr class="expando-row">
                            <td colspan="5">
                                <dl>
                                    {% for key, value in vulnerability.items %}
                                        <div>
                                            <dt>{{ key }}</dt>
                                            <dd>
                                                {% if key == "CVSS" %}
                                                    <span class="{{ value.class }}">{{ value.severity }}</span>
                                                {% else %}
                                                    {{ value }}
                                                {% endif %}
                                            </dd>
                                        </div>
                                    {% endfor %}
                                </dl>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endif %}
