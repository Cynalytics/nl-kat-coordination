{% load i18n %}
{% load static %}

<script nonce="{{ request.csp_nonce }}"
        src=" https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js "></script>
<section id="cynalytics-report">
    {% for ip_address_findings in data.scanned_ips %}
        <div class="port-info-container">
            {% for open_port in ip_address_findings.open_ports %}
                <div>
                    {% if open_port in data.common_ports %}
                        <p class="open-common-port">
                            <span>common</span>
                            <br />
                            port: {{ open_port }}
                        </p>
                    {% elif open_port in data.dangerous_ports %}
                        <p class="open-dangerous-port">
                            <span>dangerous</span>
                            <br />
                            port: {{ open_port }}
                        </p>
                    {% elif open_port in data.critical_ports %}
                        <p class="open-critical-port">
                            <span>critical</span>
                            <br />
                            port: {{ open_port }}
                        </p>
                    {% else %}
                        <p class="port-info">
                            <span>open</span>
                            <br />
                            port: {{ open_port }}
                        </p>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% endfor %}
</section>
<script type="module" nonce="{{ request.csp_nonce }}">
    (async function () {
        const data = [
            { year: 2010, count: 10 },
            { year: 2011, count: 20 },
            { year: 2012, count: 15 },
            { year: 2013, count: 25 },
            { year: 2014, count: 22 },
            { year: 2015, count: 30 },
            { year: 2016, count: 28 },
        ];

        new Chart(document.getElementById("acquisitions"), {
            type: "bar",
            data: {
                labels: data.map((row) => row.year),
                datasets: [
                    {
                        label: "Acquisitions by year",
                        data: data.map((row) => row.count),
                    },
                ],
            },
        });
    })();
</script>
